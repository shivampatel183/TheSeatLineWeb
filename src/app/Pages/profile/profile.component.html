<div class="profile-container">
  <!-- Loading State -->
  <div *ngIf="isLoading" class="loading-overlay">
    <div class="spinner"></div>
  </div>

  <!-- Profile Header -->
  <div class="profile-header">
    <div class="profile-avatar">
      <div class="avatar-circle">{{ getInitials() }}</div>
    </div>
    <div class="profile-info">
      <h1>{{ user?.fullName || 'User' }}</h1>
      <p class="email">{{ user?.email }}</p>
    </div>
    <button class="logout-btn" (click)="logout()">
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
        <polyline points="16 17 21 12 16 7"></polyline>
        <line x1="21" y1="12" x2="9" y2="12"></line>
      </svg>
      Logout
    </button>
  </div>

  <!-- Profile Content -->
  <div class="profile-content">
    <!-- Personal Information Card -->
    <div class="info-card">
      <div class="card-header">
        <h2>Personal Information</h2>
        <button class="edit-btn" (click)="toggleEditMode()" *ngIf="!isEditMode">
          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
          </svg>
          Edit
        </button>
      </div>

      <!-- View Mode -->
      <div class="info-grid" *ngIf="!isEditMode">
        <div class="info-item">
          <label>Full Name</label>
          <p>{{ user?.fullName || 'Not provided' }}</p>
        </div>
        <div class="info-item">
          <label>Email</label>
          <p>{{ user?.email || 'Not provided' }}</p>
        </div>
        <div class="info-item">
          <label>Phone</label>
          <p>{{ user?.phone || 'Not provided' }}</p>
        </div>
        <div class="info-item">
          <label>City</label>
          <p>{{ user?.city || 'Not provided' }}</p>
        </div>
        <div class="info-item">
          <label>State</label>
          <p>{{ user?.state || 'Not provided' }}</p>
        </div>
        <div class="info-item">
          <label>Zip Code</label>
          <p>{{ user?.zipCode || 'Not provided' }}</p>
        </div>
        <div class="info-item full-width">
          <label>Address</label>
          <p>{{ user?.address || 'Not provided' }}</p>
        </div>
      </div>

      <!-- Edit Mode -->
      <div class="edit-form" *ngIf="isEditMode">
        <div class="form-grid">
          <div class="form-group">
            <label>Full Name *</label>
            <input type="text" [(ngModel)]="editData.fullName" required />
          </div>
          <div class="form-group">
            <label>Phone</label>
            <input type="tel" [(ngModel)]="editData.phone" />
          </div>
          <div class="form-group">
            <label>City</label>
            <input type="text" [(ngModel)]="editData.city" />
          </div>
          <div class="form-group">
            <label>State</label>
            <input type="text" [(ngModel)]="editData.state" />
          </div>
          <div class="form-group">
            <label>Zip Code</label>
            <input type="text" [(ngModel)]="editData.zipCode" />
          </div>
          <div class="form-group full-width">
            <label>Address</label>
            <input type="text" [(ngModel)]="editData.address" />
          </div>
        </div>
        <div class="form-actions">
          <button class="btn-secondary" (click)="toggleEditMode()">Cancel</button>
          <button class="btn-primary" (click)="saveProfile()">Save Changes</button>
        </div>
      </div>
    </div>

    <!-- Change Password Card -->
    <div class="info-card">
      <div class="card-header">
        <h2>Security</h2>
        <button class="edit-btn" (click)="togglePasswordChange()" *ngIf="!isChangingPassword">
          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
            <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
          </svg>
          Change Password
        </button>
      </div>

      <div *ngIf="!isChangingPassword" class="security-info">
        <p>Keep your account secure by using a strong password.</p>
      </div>

      <div class="edit-form" *ngIf="isChangingPassword">
        <div class="form-grid">
          <div class="form-group full-width">
            <label>Current Password *</label>
            <input type="password" [(ngModel)]="passwordData.currentPassword" required />
          </div>
          <div class="form-group full-width">
            <label>New Password *</label>
            <input type="password" [(ngModel)]="passwordData.newPassword" required />
          </div>
          <div class="form-group full-width">
            <label>Confirm New Password *</label>
            <input type="password" [(ngModel)]="passwordData.confirmPassword" required />
          </div>
        </div>
        <div class="form-actions">
          <button class="btn-secondary" (click)="togglePasswordChange()">Cancel</button>
          <button class="btn-primary" (click)="changePassword()">Update Password</button>
        </div>
      </div>
    </div>
  </div>
</div>
